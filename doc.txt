Документация

Функция: «Авторизация пользователя»
Функция реализует процесс входа пользователя в систему с проверкой логина, пароля и состояния учетной записи.
Входные данные: Ввод пользователем с клавиатуры в поля: «Логин» и «Пароль».
Выходные данные: Открытие соответствующего окна приложения в зависимости от роли пользователя (администратор или пользователь), либо вывод сообщения об ошибке.
Логика работы:
1) Считываются введённые пользователем логин и пароль.
2) Если одно из полей пустое — выводится предупреждающее сообщение.
3) В базе данных выполняется поиск пользователя по логину с подгрузкой его роли.
4) Если пользователь не найден — выводится сообщение об ошибке.
5) Если пароль введён неверно:
a) Увеличивается счётчик неудачных попыток.
b) Если попыток три — пользователь блокируется.
c) Иначе — выводится сообщение о количестве оставшихся попыток.
d) Если пользователь уже заблокирован — выводится сообщение об этом.
6) Если пользователь не входил в систему более 30 дней — аккаунт блокируется и выводится сообщение.

7) В случае успешной авторизации:
a) Сбрасывается счётчик неудачных попыток.
b) Если дата последнего входа отсутствует, устанавливается флаг isfirstlogin = true.
c) Обновляется дата последнего входа.
d) Пользователь перенаправляется в соответствующее окно по своей роли. Если роль «Администратор» — открывается окно администратора. Если роль «Пользователь» и это первый вход — открывается окно пользователя.
e) Отображается сообщение об успешной авторизации

Функция: «Изменение пароля пользователя»
Данная функция реализует процесс смены пароля текущего пользователя с проверкой корректности введённых данных.
Входные данные: Ввод пользователем с клавиатуры в поля: «Старый пароль», «Новый пароль», «Повтор нового пароля».
Выходные данные: Сохранение нового пароля и обновление флага первого входа в базе данных либо отображение сообщения об ошибке.
1) Считываются значения из всех полей ввода.
2) Если одно из полей не заполнено — выводится предупреждающее сообщение.
3) Проверяется соответствие введённого старого пароля текущему паролю пользователя.
4) Проверяется совпадение нового пароля и его повторного ввода.
5) В случае успешной проверки:
a) Новый пароль сохраняется в объект пользователя.
b) Устанавливается флаг isfirstlogin = false, указывающий, что пользователь больше не находится на первом входе.
c) Изменения сохраняются в базе данных.

d) Выводится сообщение об успешной смене пароля.
e) В случае исключения — выводится сообщение об ошибке

Функция: «Добавление и редактирование пользователя»
Данная функция реализует добавление нового пользователя в систему или редактирование существующего в зависимости от переданного параметра.
Входные данные: Ввод данных с клавиатуры в поля: «Логин», «Пароль».
Выходные данные: Добавление новой записи в таблицу пользователей или обновление существующей записи. Отображение сообщений об ошибке или успешном выполнении.
1) Считываются введённые логин и пароль.
2) Если поля не заполнены — выводится предупреждение.
3) Открывается подключение к базе данных.
4) В режиме добавления (_editUser == null):
a) Проверяется, существует ли пользователь с таким логином.
b) Если существует — выводится сообщение об ошибке.
c) Иначе — создается новый пользователь с ролью «Пользователь», добавляется в базу.
5) В режиме редактирования:
a) Получается объект пользователя по ID.
b) Обновляются логин и пароль.
c) Сохраняются изменения в базу данных.
d) Окно закрывается.
e) В случае исключения — выводится сообщение об ошибке.


Функция: «Разблокировка пользователя»
Данная функция реализует снятие блокировки с выбранного пользователя в системе.
Входные данные: Выбор пользователя.
Выходные данные: Сброс признака блокировки и количества неудачных попыток входа. Обновление данных в базе. Отображение сообщения об успешной разблокировке.
1) Проверяется, выбран ли пользователь в таблице.
2) Выполняется поиск пользователя в базе данных по идентификатору.
3) Если пользователь найден:
a) Сбрасывается флаг isblocked.
b) Обнуляется счётчик failedattempts.
c) Изменения сохраняются в базе.
d) Отображается сообщение об успешной разблокировке.
e) Обновляется список пользователей на экране.
